<form [formGroup]="eventForm" class="flex between column">
  <mat-form-field class="filed-wrap">
    <mat-label>Title</mat-label>
    <input
      type="text"
      matInput
      formControlName="title"
      placeholder="Some text"
    />
  </mat-form-field>
  <div
    *ngIf="
      formControlsTitle['title']?.invalid &&
      (formControlsTitle['title'].dirty || formControlsTitle['title'].touched)
    "
    class="alert"
  >
    <div *ngIf="formControlsTitle['title'].errors?.['required']">
      Name is required.
    </div>
    <div *ngIf="formControlsTitle['title'].errors?.['maxlength']">
      Title length max {{ lengthOfTitle }}.
    </div>
  </div>
  <mat-form-field class="filed-wrap">
    <mat-label>Time</mat-label>
    <input type="time" matInput formControlName="time" />
  </mat-form-field>

  <mat-form-field>
    <mat-label>Invited Attendees</mat-label>
    <mat-chip-grid #chipGrid aria-label="Attendee selection">
      @for (selectedAttendee of selectedAttendees(); track $index) {
      <mat-chip-row (removed)="removeAttendee(selectedAttendee)">
        {{ selectedAttendee.email }}
        <button
          matChipRemove
          [attr.aria-label]="'remove ' + selectedAttendee.email"
        >
          <mat-icon>cancel</mat-icon>
        </button>
      </mat-chip-row>
      }
    </mat-chip-grid>
    <mat-label>Attendees</mat-label>
    <input
      type="text"
      placeholder="Pick the Attendee"
      matInput
      #attendeeInput
      [formControl]="searchFragment"
      [matChipInputFor]="chipGrid"
      [matAutocomplete]="auto"
    />
    <mat-autocomplete
      autoActiveFirstOption
      #auto="matAutocomplete"
      (optionSelected)="selectedAttendee($event)"
    >
      @for (attendee of attendeeList$ | async; track attendee) {
      <mat-option [value]="attendee">{{ attendee.email }}</mat-option>
      }
    </mat-autocomplete>
  </mat-form-field>

  <button
    class="action"
    mat-raised-button
    color="primary"
    [disabled]="eventForm.invalid"
    (click)="submitForm()"
  >
    Save
  </button>
  <button
    class="action"
    mat-raised-button
    color="warn"
    *ngIf="isDeletable?.isAllowed"
    (click)="deleteEvent()"
  >
    Delete
  </button>
  <ng-content></ng-content>
</form>
